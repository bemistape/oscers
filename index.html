<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>OSCER Bingo Card Generator</title>
  <style>
    /* General Styling */
    body {
      font-family: 'Arial', sans-serif;
      text-align: center;
      margin: 20px;
      transition: background-color 0.3s, color 0.3s;
    }
    h1 {
      margin-top: 20px;
      font-size: 32px;
      text-transform: uppercase;
      font-weight: bold;
      letter-spacing: 2px;
      transition: color 0.3s, text-shadow 0.3s;
    }
    #controls {
      margin-bottom: 20px;
    }
    button {
      padding: 12px 20px;
      font-size: 16px;
      margin: 10px;
      border: none;
      cursor: pointer;
      border-radius: 5px;
      transition: transform 0.3s, background 0.3s;
      box-shadow: 0px 4px 8px rgba(0,0,0,0.2);
    }
    button:hover {
      transform: scale(1.05);
    }
    select {
      padding: 8px;
      font-size: 16px;
      border-radius: 5px;
      border: 1px solid #ccc;
      margin-left: 10px;
    }

    /* Table Styling */
    #bingo-table {
      margin: 20px auto;
      border-collapse: collapse;
      width: 90%;
      max-width: 500px;
      border-radius: 8px;
      overflow: hidden;
      /* No table-layout: fixed */
    }
    th, td {
      border: 2px solid;
      text-align: center;
      font-size: 16px;
      cursor: pointer;
      transition: background 0.2s, transform 0.2s;
      padding: 8px;
      vertical-align: middle;
      /* Provide a minimum size but allow expansion */
      min-width: 80px;
      min-height: 60px;
      word-wrap: break-word;
    }
    th {
      font-weight: bold;
      letter-spacing: 1px;
      transition: background 0.3s, color 0.3s;
    }
    td.free-space {
      font-size: 18px;
      font-weight: bold;
    }
    td.marked {
      font-weight: bold;
      transform: scale(1.05);
    }
    td.bingo {
      animation: glow 1s infinite alternate;
    }
    @keyframes glow {
      0% { box-shadow: 0 0 10px rgba(255, 215, 0, 0.5); }
      100% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.9); }
    }

    /* Modal for Bingo Celebration */
    #bingoModal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.8);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    #bingoModal #bingoMessage {
      font-size: 48px;
      font-weight: bold;
      transition: color 0.3s, text-shadow 0.3s;
    }

    /* Theme: Classic Oscars (Gold & Black) */
    .theme-classic {
      background-color: #1c1c1c;
      color: #ffd700;
    }
    .theme-classic h1 { color: #ffd700; text-shadow: 2px 2px 5px rgba(255,215,0,0.6); }
    .theme-classic button {
      background: linear-gradient(45deg, #ffd700, #e5c100);
      color: black;
    }
    .theme-classic #bingo-table {
      background-color: #222;
      border: 2px solid #ffd700;
    }
    .theme-classic th {
      background-color: #ffd700;
      color: black;
    }
    .theme-classic td {
      background-color: #1c1c1c;
      color: #fff;
    }
    .theme-classic td.free-space { background-color: #ffd700; color: black; }
    #bingoModal.theme-classic #bingoMessage { color: #ffd700; text-shadow: 2px 2px 10px rgba(255,215,0,0.8); }

    /* Theme: Modern Red Carpet (Red & Silver) */
    .theme-modern {
      background-color: #2c2c2c;
      color: #c0c0c0;
    }
    .theme-modern h1 { color: #e60000; text-shadow: 2px 2px 5px rgba(230,0,0,0.6); }
    .theme-modern button {
      background: linear-gradient(45deg, #e60000, #c70000);
      color: white;
    }
    .theme-modern #bingo-table {
      background-color: #3d3d3d;
      border: 2px solid #c0c0c0;
    }
    .theme-modern th { background-color: #c0c0c0; color: black; }
    .theme-modern td { background-color: #2c2c2c; color: #c0c0c0; }
    .theme-modern td.free-space { background-color: #c0c0c0; color: black; }
    #bingoModal.theme-modern #bingoMessage { color: #e60000; text-shadow: 2px 2px 10px rgba(230,0,0,0.8); }

    /* Theme: Silent Film Era (Sepia & Vintage) */
    .theme-silent {
      background-color: #f4ecd8;
      color: #5b4636;
    }
    .theme-silent h1 { color: #5b4636; text-shadow: 2px 2px 5px rgba(91,70,54,0.6); }
    .theme-silent button {
      background: linear-gradient(45deg, #c49e70, #a57c50);
      color: white;
    }
    .theme-silent #bingo-table {
      background-color: #fdf6e3;
      border: 2px solid #5b4636;
    }
    .theme-silent th { background-color: #5b4636; color: white; }
    .theme-silent td { background-color: #fdf6e3; color: #5b4636; }
    .theme-silent td.free-space { background-color: #5b4636; color: white; }
    #bingoModal.theme-silent #bingoMessage { color: #5b4636; text-shadow: 2px 2px 10px rgba(91,70,54,0.8); }

    /* Mobile Optimization */
    @media (max-width: 600px) {
      th, td {
        font-size: 14px;
        padding: 6px;
        min-width: 60px;
        min-height: 50px;
      }
      button, select {
        font-size: 14px;
        padding: 10px;
      }
    }
  </style>
</head>
<body class="theme-classic">
  <h1>OSCER Bingo Card Generator</h1>
  <div id="controls">
    <button onclick="generateBingoCard()">Generate New Card</button>
    <button onclick="saveAndShare()">Save & Share</button>
    <select id="themeSelector" onchange="changeTheme(this.value)">
      <option value="classic">Classic Oscars (Gold & Black)</option>
      <option value="modern">Modern Red Carpet (Red & Silver)</option>
      <option value="silent">Silent Film Era (Sepia & Vintage)</option>
    </select>
  </div>
  <div id="bingoContainer">
    <table id="bingo-table">
      <thead>
        <tr>
          <th>O</th>
          <th>S</th>
          <th>C</th>
          <th>E</th>
          <th>R</th>
        </tr>
      </thead>
      <tbody>
        <!-- Bingo card cells go here -->
      </tbody>
    </table>
  </div>

  <!-- Modal overlay for Bingo Celebration -->
  <div id="bingoModal" class="theme-classic">
    <div id="bingoMessage">Bingo!</div>
  </div>

  <!-- Audio for bingo chime -->
  <audio id="bingoSound" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg"></audio>
  <!-- Audio for click -->
  <audio id="clickSound" src="https://actions.google.com/sounds/v1/cartoon/pop.ogg" preload="auto"></audio>

  <!-- Include html2canvas for saving the card -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <!-- Include canvas-confetti for confetti effect -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>

  <script>
    // FULL TIER DATA with 161 items here, truncated for brevity:
    const tier1 = [...];  // 62 items
    const tier2 = [...];  // 38 items
    const tier3 = [...];  // 61 items

    // Weighted pool
    function buildWeightedPool() {
      const pool = [];
      tier1.forEach(option => pool.push(...Array(3).fill(option)));
      tier2.forEach(option => pool.push(...Array(2).fill(option)));
      tier3.forEach(option => pool.push(option));
      return pool;
    }

    // Select 24 unique items
    function weightedSelect(count) {
      let pool = buildWeightedPool();
      const result = [];
      while (result.length < count && pool.length) {
        const idx = Math.floor(Math.random() * pool.length);
        const selected = pool[idx];
        pool = pool.filter(item => item !== selected);
        result.push(selected);
      }
      return result;
    }

    // Check for Bingo
    function checkBingo() {
      const rows = document.querySelectorAll("#bingo-table tbody tr");
      const grid = [...rows].map(row => [...row.children]);
      let bingoFound = false;

      // Rows & columns
      for (let i = 0; i < 5; i++) {
        if (grid[i].every(td => td.classList.contains("marked"))) {
          highlightBingo(grid[i]);
          bingoFound = true;
        }
        const colCells = grid.map(row => row[i]);
        if (colCells.every(td => td.classList.contains("marked"))) {
          highlightBingo(colCells);
          bingoFound = true;
        }
      }
      // Diagonals
      const diag1 = [0,1,2,3,4].map(i => grid[i][i]);
      const diag2 = [0,1,2,3,4].map(i => grid[i][4-i]);
      if (diag1.every(td => td.classList.contains("marked"))) {
        highlightBingo(diag1);
        bingoFound = true;
      }
      if (diag2.every(td => td.classList.contains("marked"))) {
        highlightBingo(diag2);
        bingoFound = true;
      }
      if (bingoFound) {
        triggerBingoCelebration();
      }
    }

    // Highlight winning squares
    function highlightBingo(cells) {
      cells.forEach(td => td.classList.add("bingo"));
    }

    // Bingo celebration
    function triggerBingoCelebration() {
      document.getElementById("bingoSound").play();
      const modal = document.getElementById("bingoModal");
      modal.style.display = "flex";
      setTimeout(() => { modal.style.display = "none"; }, 2000);
      confetti({
        particleCount: 100,
        spread: 70,
        origin: { y: 0.6 }
      });
    }

    // Generate the Bingo card
    function generateBingoCard() {
      const tbody = document.querySelector("#bingo-table tbody");
      tbody.innerHTML = "";
      const totalCells = 25;
      const numItems = totalCells - 1;
      const items = weightedSelect(numItems);
      let itemIndex = 0;

      for (let row = 0; row < 5; row++) {
        const tr = document.createElement("tr");
        for (let col = 0; col < 5; col++) {
          const td = document.createElement("td");
          td.onclick = () => {
            // Play click
            const clickAudio = document.getElementById("clickSound");
            clickAudio.currentTime = 0;
            clickAudio.play();

            // Mark/unmark
            td.classList.toggle("marked");
            if (!td.classList.contains("marked")) td.classList.remove("bingo");
            checkBingo();
          };
          if (row === 2 && col === 2) {
            td.textContent = "ðŸ¿";
            td.classList.add("free-space", "marked");
          } else {
            td.textContent = items[itemIndex] || "";
            itemIndex++;
          }
          tr.appendChild(td);
        }
        tbody.appendChild(tr);
      }
    }

    // Theme switching
    function changeTheme(theme) {
      document.body.classList.remove("theme-classic", "theme-modern", "theme-silent");
      document.getElementById("bingoModal").classList.remove("theme-classic", "theme-modern", "theme-silent");
      if (theme === "classic") {
        document.body.classList.add("theme-classic");
        document.getElementById("bingoModal").classList.add("theme-classic");
      } else if (theme === "modern") {
        document.body.classList.add("theme-modern");
        document.getElementById("bingoModal").classList.add("theme-modern");
      } else if (theme === "silent") {
        document.body.classList.add("theme-silent");
        document.getElementById("bingoModal").classList.add("theme-silent");
      }
    }

    // Save & Share
    function saveAndShare() {
      html2canvas(document.getElementById("bingo-table")).then(canvas => {
        const dataURL = canvas.toDataURL();
        const link = document.createElement("a");
        link.href = dataURL;
        link.download = "oscer_bingo_card.png";
        link.click();
      });
    }

    // On load
    document.addEventListener("DOMContentLoaded", () => {
      generateBingoCard();
      changeTheme(document.getElementById("themeSelector").value);
    });
  </script>
</body>
</html>